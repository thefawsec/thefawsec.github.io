<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="CTF-Red @ BsidesIslamabad-2020 - Pakistan’s first ever Bsides" /><meta property="og:locale" content="en_US" /><meta name="description" content="Assalam-o-Alaikum folks! I hope you guys are safe and sound in this pandemic." /><meta property="og:description" content="Assalam-o-Alaikum folks! I hope you guys are safe and sound in this pandemic." /><link rel="canonical" href="https://thefawsec.github.io/posts/CTF-Red-BsidesIslamabad-2020/" /><meta property="og:url" content="https://thefawsec.github.io/posts/CTF-Red-BsidesIslamabad-2020/" /><meta property="og:site_name" content="theFawsec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-16T15:00:00+05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CTF-Red @ BsidesIslamabad-2020 - Pakistan’s first ever Bsides" /><meta name="twitter:site" content="@thefawsec" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Assalam-o-Alaikum folks! I hope you guys are safe and sound in this pandemic.","url":"https://thefawsec.github.io/posts/CTF-Red-BsidesIslamabad-2020/","@type":"BlogPosting","headline":"CTF-Red @ BsidesIslamabad-2020 - Pakistan’s first ever Bsides","dateModified":"2021-04-12T18:14:21+05:00","datePublished":"2020-11-16T15:00:00+05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://thefawsec.github.io/posts/CTF-Red-BsidesIslamabad-2020/"},"@context":"https://schema.org"}</script><title>CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides | theFawsec</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatars/dp.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">theFawsec</a></div><div class="site-subtitle font-italic">A cyber security enthusiast & aspiring penetration tester, interested in red teaming.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/thefawsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/thefawsec" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['fawaz_masood','hotmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/fawaz-masood-qureshi" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Fawaz Masood Qureshi </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 16, 2020, 3:00 PM +0500" prep="on" > Nov 16, 2020 <i class="unloaded">2020-11-16T15:00:00+05:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 12, 2021, 6:14 PM +0500" prefix="Updated " > Apr 12 <i class="unloaded">2021-04-12T18:14:21+05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1999 words">11 min</span></div></div><div class="post-content"><p><strong>Assalam-o-Alaikum folks!</strong> I hope you guys are safe and sound in this pandemic.</p><p>BsidesIslamabad-2020 was the first ever Bsides cyber security conference of Pakistan, conducted on <em>November 7th-8th 2020</em>. For those who don’t know what <em>Bsides</em> is:</p><blockquote><p>BSides is a community-driven framework for building events for and by information security community members.</p></blockquote><p>BsidesIslamabad had a lot of amazing speakers, workshops on hardware hacking and reverse-engineering and two CTFs:</p><ul><li><span style="color:red"> CTF-Red (offensive) </span><li><span style="color:blue"> CTF-Blue (defensive) </span></ul><p>In this blog post I am going to talk about some of the challenges from <span style="color:red">CTF-Red</span> of BsidesIslamabad 2020. The challenges were divided into different categories like web,binary,cloud etc. The allowed time period was 6 hours and during that I was able to solve only 5 challenges of web categories, though after the ctf finished, I was able to solve a few more.</p><p>Enough for the boring talk, let’s jump into the challenges. Here I am going to talk about following challenges:</p><ol><li>Easy Peasy<li>InjectedOrg<li>Manipulator<li>ShaktimanDaDev<li>BrokenAuth<li>Remani<li>X-Pass<li>HackTheAdmin</ol><h1 id="easy-peasy">Easy Peasy</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/easy-peasy.png" alt="Easy Peasy" /></p><p>The home page contains just a background image and nothing else. First two things I usually do in such scenario is to look into the source code for any javascript file, and 2nd thing is to run directory brutefoce to find any hidden content. Though there were no JS files, I did get some hidden directories.</p><p>Command:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dirsearch <span class="nt">-u</span> https://target-url/ <span class="nt">-e</span> <span class="o">[</span>EXTENSIONS] <span class="nt">-w</span> <span class="o">[</span>WORDLIST]
</pre></table></code></div></div><p>Output:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/easy-peasy-dir-search.png" alt="Easy Peasy dirsearch" /></p><p>There was nothing usefull inside <em>1.txt</em> &amp; <em>2.txt</em>. The file <code class="language-plaintext highlighter-rouge">index.php</code> had following content: <code class="language-plaintext highlighter-rouge">hey to access notes just change the id parameter (for example 1,2,3)... you are not allowed to access secret file</code></p><p>Well we usaully do something that we are specifically told not to do, right? So I tried to access the secret file:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://target-url/index.php?id<span class="o">=</span>secret.txt
</pre></table></code></div></div><p>Output of this file was something like this: <code class="language-plaintext highlighter-rouge">....pssssttt.... flag is one directory up....its named flag.txt</code></p><p>So now I replaced the <code class="language-plaintext highlighter-rouge">secret.txt</code> with <code class="language-plaintext highlighter-rouge">flag.txt</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/easy-peasy-flag.txt.png" alt="Easy Peasy Not Easy" /></p><p>Not that easy right? Well looking back at the output of <code class="language-plaintext highlighter-rouge">secret.txt</code> it says one directory up!</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://target-url/index.php?id=../flag.txt
</pre></table></code></div></div><p><strong>Voila!</strong> challenge Solved!</p><h2 id="vulnerability">Vulnerability?</h2><p>Well the vulnerability we just exploited is known as <code class="language-plaintext highlighter-rouge">Local File Inclusion</code>.</p><blockquote><p>LFI</p><p>An attacker can use Local File Inclusion (LFI) to trick the web application into exposing or running files on the web server. Typically, LFI occurs when an application uses the path to a file as input. If the application treats this input as trusted, a local file may be used in the include statement.</p></blockquote><hr /><h1 id="injectedorg">InjectedOrg</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/injectedOrg.png" alt="InjectedOrg" /></p><p>Main page contains details of some users where I can edit their data, add new user or delete the existing users. Here I did tried a few things like IDOR, trying to find if there is any hidden user (may be an admin?), tried XSS (I don’t know why I tried XSS), though I did got an alert box but did not know what to do with that … sed life!</p><p>Looking back at the name of this challenge, I had an epiphany! Sql<strong>Injection</strong> (InjectedOrg =&gt; Injection, see! clever right?). Well I selected a user and the Url had an id paramter, simply added an apostrophe (<strong><code class="language-plaintext highlighter-rouge">'</code></strong>) and in response got a sql error!</p><p>Then the further steps were easy:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python sqlmap.py <span class="nt">-u</span> <span class="s2">"http://target-url/read.php?id=1"</span> <span class="nt">--tables</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/injectedOrg-tables.png" alt="InjectedOrg DB Tables" /></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python sqlmap.py <span class="nt">-u</span> <span class="s2">"http://target-url/read.php?id=1"</span> <span class="nt">-D</span> bruhpls <span class="nt">-T</span> flag <span class="nt">--dump</span>
</pre></table></code></div></div><p>Output contained the flag, challenge solved!</p><h2 id="vulnerability-1">Vulnerability?</h2><p>The vulnerability we just exploited is known as <code class="language-plaintext highlighter-rouge">SqlInjection</code></p><blockquote><p>SQLi</p><p>SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database.</p></blockquote><hr /><h1 id="manipulator">Manipulator</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/manipulator.png" alt="Manipulator" /></p><p>We have a link shared by our friend who is existing user of this web application. Upon clicking the link we are welcomed with a registration form to register our account. Here is the request that is sent to register the user:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/manipulator-register-request.png" alt="Manipulator Request" /></p><p>And here is the response to this request:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/manipulator-register-response.png" alt="Manipulator Rsponse" /></p><p>Looking at the request and response of this process, one thing that got my attention was <code class="language-plaintext highlighter-rouge">user_id</code> cookie in response. So what if we intercept the response and change the cookie value?</p><p>If we look at the link that we got from the already registered user, we can see a <code class="language-plaintext highlighter-rouge">referrerId</code> parameter in that link. So we have the id of our friend. Replace the id of newly registered user in response, with our friend’s id.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/manipulator-register-response-changed.png" alt="Manipulator Rsponse Changed" /></p><p>And we successfully got access to our friend’s account:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/manipulator-flag-found.png" alt="Manipulator Flag Found" /></p><h2 id="vulnerability-2">Vulnerability?</h2><p>I think the main issue here is that the authentication and authorization is solely handled by a single cookie value which is just the user-id. User-ids can be found by different ways so once a user-id is disclosed, that user is done!</p><hr /><h1 id="shaktimandadev">ShaktimanDaDev</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/ShaktimanDaDev.png" alt="ShaktimanDaDev" /></p><p>There were two pages accessible of this web app. Home page containing the basic introduction of who shaktiman is and about page containing details about shaktiman. While reading the about page, following paragraph caught my attention:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/ShaktimanDaDev-about.png" alt="ShaktimanDaDev about" /></p><p>So we have to read the source code of this web application right? Well there was some <em><code class="language-plaintext highlighter-rouge">protection</code></em> to access the source code. Like we can’t use usual ways like <code class="language-plaintext highlighter-rouge">Ctrl+u</code>, <code class="language-plaintext highlighter-rouge">Ctrl+j</code>, <code class="language-plaintext highlighter-rouge">Ctrl+Shift+i</code> etc.</p><p>So how can we access the source code? You know how, right? . . . . . No? Well google is your friend (is it?). A simple google search tells you to open developer tools from browser drop-down menu rather than <code class="language-plaintext highlighter-rouge">Ctrl+Shift+i</code> shortcut.</p><p><strong>There was a <code class="language-plaintext highlighter-rouge">security.js</code> file which tells us how to disable the protection, simply use <code class="language-plaintext highlighter-rouge">ctrl+c, ctrl+u</code></strong></p><p>In the source code found another js file <code class="language-plaintext highlighter-rouge">home-css-js-js-change-nhp.js</code>. This was the file that Shaktiman referred to in his about page.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/ShaktimanDaDev-Js-content.png" alt="ShaktimanDaDev JS File" /></p><p>The content of file is not properly readable, so used an online <a href="https://beautifier.io/">Js beautifier</a>:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/ShaktimanDaDev-Js-content-deobfuscated.png" alt="ShaktimanDaDev JS File" /></p><p>From this file we have a url (which was the Shaktiman’s secret portal), his username and password. Accessed that url and entered the found username &amp; password:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/ShaktimanDaDev-logedin.png" alt="ShaktimanDaDev logedIn" /></p><p>Here we got an encoded string. At this stage I simply used <code class="language-plaintext highlighter-rouge">magic</code> tool of <a href="https://gchq.github.io/CyberChef/">CyberChef</a>, and got the flag:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/ShaktimanDaDev-flag-found.png" alt="ShaktimanDaDev Flag found" /></p><h2 id="vulnerability-3">Vulnerability?</h2><p>Well i think the issue here is what we call <code class="language-plaintext highlighter-rouge">Security through Obscurity</code>. Simply disabling some shortcut keys to access source code, saving sensitive data (username,password and that url) by using so called <code class="language-plaintext highlighter-rouge">encryption</code> on some Js files is not a secure practise.</p><hr /><h1 id="brokenauth">BrokenAuth</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/brokenAuth.png" alt="Broken Auth" /></p><p>So we are moderator of this application and we have to delete a user to solve this challenge, but we are only allowed to view &amp; edit a user’s information, well atleast this is what the description and main page depicts:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/brokenAuth-home.png" alt="Broken Auth" /></p><p>After poking a little with the application I started to read the source code and found a JS file <code class="language-plaintext highlighter-rouge">BSides_Javascript.js</code>. Upon reading the JS code, found the following function:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/brokenAuth-js-content.png" alt="Broken Auth JS" /></p><p>This function tells us that to delete a user we have to send a request to <code class="language-plaintext highlighter-rouge">deleting_a_user.php</code> with username as parameter value.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://target-url/deleting_a_user.php?username=[USERNAME-HERE]
</pre></table></code></div></div><p>Username of a user can be found by viewing that user’s details. Sending the above request solved the challenge.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/brokenAuth-flag-found.png" alt="Broken Auth Flag Found" /></p><h2 id="vulnerability-4">Vulnerability?</h2><p><code class="language-plaintext highlighter-rouge">Lack of proper access control</code>. There should be proper access cotrol implemented on endpoints that are not meant for a user (in this case the moderator).</p><hr /><h1 id="remani">Remani</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/remani.png" alt="Remani" /></p><p>Here we are welcomed with a form where we have to enter our debit card details to process the payment. But after I entered the details and pressed the Subscription button I recieved an error.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/remani-home.png" alt="Remani home" /></p><p>After exmanining the request within burp suite, came to know that the response is <code class="language-plaintext highlighter-rouge">403 Forbidden</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/remani-post-request.png" alt="Remani Post" /></p><p>Unable to figure out the cause of this response, I started to look at the source code and found JS file <code class="language-plaintext highlighter-rouge">stripe.js</code>. After reading the JS code in detail, following code caught my attention as it was responsible for making that payment request:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/remani-stripe-js.png" alt="Remani JS" /></p><p>If we closely read this code, we can see a <strong>POST</strong> request is made to <strong>payment.php</strong> endpoint with the token in the body. With this request two methods are chained which are:</p><ul><li>done()<li>fail()</ul><p>Well not a JS guru here (and you don’t need be to understand the code), we can see that whenever we send this <strong>POST</strong> request, the <code class="language-plaintext highlighter-rouge">fail()</code> method is being called. So what causes this <code class="language-plaintext highlighter-rouge">fail()</code> method to get called instead of <code class="language-plaintext highlighter-rouge">done()</code>? Well the first thing that came to my mind was that maybe the reponse of this request?</p><p>So I sent the <strong>POST</strong> request again but this time intercepted the response, changed the <code class="language-plaintext highlighter-rouge">403 Forbidden</code> to <code class="language-plaintext highlighter-rouge">200 Ok</code> and VOILA!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/remani-post-request-changed.png" alt="Remani Post Changed" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/remani-flag-found.png" alt="Remani flag-found" /></p><h2 id="vulnerability-5">Vulnerability?</h2><p>Well I think this is an example of vulnerable coding, where just changing the response caused the app to process the request differently.</p><hr /><h1 id="x_pass">X_Pass</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/x_pass.png" alt="X_Pass" /></p><p>Main page has an input box where we have to enter the right password to login. As suggested in the description of the challenge that there is a client side JS algorithm, I accessed the source code and started reading the code. There found this interesting code:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/x_pass-js.png" alt="X_Pass JS" /></p><p>Here is a function <code class="language-plaintext highlighter-rouge">Validation()</code> which after doing multiple different operations, assigns a value to <code class="language-plaintext highlighter-rouge">alg_1</code> variable which is also logged in console.</p><p>Then there is an conditional statement where value of <code class="language-plaintext highlighter-rouge">alg_1</code> is comapred to <code class="language-plaintext highlighter-rouge">x</code> (this x is our supplied input)and if they are equal, then opens a new <code class="language-plaintext highlighter-rouge">url</code>.</p><p>So what I did here was that simply enter any value, hit enter, open the console and there was a value there (<code class="language-plaintext highlighter-rouge">alg_1</code>).</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/x_pass-console.png" alt="X_Pass" /></p><p>Copy this value and paste it in the input box, hit enter and the challenge is solved!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/x_pass-flag-found.png" alt="X_Pass" /></p><h2 id="vulnerability-6">Vulnerability?</h2><p>If we see, we were able to enter the correct password because that password was being logged in console. This is usually done by developers to debug the code but they may forget to remove these statments before making the application live.</p><hr /><h1 id="hacktheadmin">HackTheAdmin</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/hacktheadmin.png" alt="Hack The Admin" /></p><p>Main page had simple login form to enter username and password. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/hacktheadmin-home.png" alt="Hack The Admin Home" /></p><p>After spending a few minutes and looking through the source code, did not find anything useful.Then I ran directory bruteforce through which I was able to access a few files:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/hacktheadmin-dir-search.png" alt="Hack The Admin Dir Brut" /></p><p>These files had the following content in them:</p><ul><li><p><strong>admin.txt:</strong> <code class="language-plaintext highlighter-rouge">To use the admin panel, login. From there you can use the the panel to make requests to execute commands on our server using our secure api (found at yourdomain/api)!</code></p><li><p><strong>login.txt:</strong> <code class="language-plaintext highlighter-rouge">The default user is admin. To login go to yoursite/index.html. If you are having problems, make sure your login.php file is correctly configured.</code></p></ul><p>So maybe there is something special in <code class="language-plaintext highlighter-rouge">login.php</code>? Well turns out there is nothing in reponse if we directly access the <code class="language-plaintext highlighter-rouge">login.php</code> file.</p><p><code class="language-plaintext highlighter-rouge">info.php</code> had the following content:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/hacktheadmin-info.png" alt="Hack The Admin info" /></p><p>Accessing the <strong>Login Help</strong> we ended up on the following endpoint : <code class="language-plaintext highlighter-rouge">/helpdisplay.php?help=login.txt</code> containing the response of <code class="language-plaintext highlighter-rouge">login.txt</code> file.</p><p>Changed the <code class="language-plaintext highlighter-rouge">login.txt</code> with <code class="language-plaintext highlighter-rouge">login.php</code> and this time there was some content in reponse but not much meaningful. Upon this I accessed the same Url again <code class="language-plaintext highlighter-rouge">/helpdisplay.php?help=login.php</code> and analyzed the response in burp suite.</p><p>In the response we can see following php code:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/hacktheadmin-php-disclose.png" alt="Hack The Admin disclose" /></p><p>So following this code, we can see that we have another <code class="language-plaintext highlighter-rouge">.php</code> file but we can’t access it directly. Reading the code suggest that username is <code class="language-plaintext highlighter-rouge">admin</code> and there is cookie <code class="language-plaintext highlighter-rouge">user</code> whose value is base-64 encoded username <code class="language-plaintext highlighter-rouge">admin</code>.</p><p>So I sent a <code class="language-plaintext highlighter-rouge">GET</code> request to <code class="language-plaintext highlighter-rouge">/Cantbeaccessedwithoutlogin.php</code> with the cookie: <code class="language-plaintext highlighter-rouge">user= YWRtaW4=</code></p><p>Here <code class="language-plaintext highlighter-rouge">YWRtaW4=</code> is base-64 encoding of the word <code class="language-plaintext highlighter-rouge">admin</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/bsidesisb2020/hacktheadmin-flag-found.png" alt="Hack The Admin flag found" /></p><p>In response we receive a flag and the challenge is solved!</p><h2 id="vulnerability-7">Vulnerability?</h2><p><code class="language-plaintext highlighter-rouge">Source code disclosure</code> &amp; <code class="language-plaintext highlighter-rouge">use of weak encoding</code>. Using base64 to encode some sensitive data and depending on that data for authentication or authorization puprose can lead to severe issues.</p><hr /><h1 id="finishing-note">Finishing note</h1><p>Well thats all folks. I hope you guys enjoyed this post and learnt something new today. I would like to thank the team behind <a href="https://www.bsidesislamabad.com/">BsidesIslamabad</a> for such an amazing event.</p><p>If anyone have any questions or you just wanna talk about cyber security in general, feel free to shoot a dm on twitter or linkedIn, as I am always open to talk, discuss and learn new things.</p><h3 id="thank-you">Thank you!</h3></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf-walkthroughs/'>CTF-Walkthroughs</a>, <a href='/categories/cybersecurity-competitions/'>CyberSecurity-Competitions</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/competition/" class="post-tag no-text-decoration" >competition</a> <a href="/tags/bsidespakistan/" class="post-tag no-text-decoration" >bsidespakistan</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides - theFawsec&url=https://thefawsec.github.io/posts/CTF-Red-BsidesIslamabad-2020/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides - theFawsec&u=https://thefawsec.github.io/posts/CTF-Red-BsidesIslamabad-2020/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides - theFawsec&url=https://thefawsec.github.io/posts/CTF-Red-BsidesIslamabad-2020/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://thefawsec.github.io/posts/CTF-Red-BsidesIslamabad-2020/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CTF-Red-BsidesIslamabad-2020/">CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides</a><li><a href="/posts/Hacky-Holidays-2020/">Hacky-Holidays. A Tale of Saving The Holidays</a><li><a href="/posts/THM-Internal/">TryHackMe - Internal</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/competition/">competition</a> <a class="post-tag" href="/tags/bsidespakistan/">bsidespakistan</a> <a class="post-tag" href="/tags/hackerone/">hackerone</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Hacky-Holidays-2020/"><div class="card-body"> <span class="timeago small" > Jan 15 <i class="unloaded">2021-01-15T21:00:00+05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hacky-Holidays. A Tale of Saving The Holidays</h3><div class="text-muted small"><p> Assalam-o-Alaikum &amp; Hello Folks! I hope you are doing well. Today I am here with the detailed writeup of a ctf organized by Hackerone which started in 2nd week of December 2020. It was a 12 da...</p></div></div></a></div><div class="card"> <a href="/posts/THM-Internal/"><div class="card-body"> <span class="timeago small" > Apr 12 <i class="unloaded">2021-04-12T18:00:00+05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe - Internal</h3><div class="text-muted small"><p> Intenal is a hard difficulty penetration testing challenge created by TheMayor. Enumeration Lets start our nmap scan and see what ports are open and what services are running on these ports. nmap ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/Hacky-Holidays-2020/" class="btn btn-outline-primary" prompt="Newer"><p>Hacky-Holidays. A Tale of Saving The Holidays</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/thefawsec">Fawaz Masood Qureshi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/competition/">competition</a> <a class="post-tag" href="/tags/bsidespakistan/">bsidespakistan</a> <a class="post-tag" href="/tags/hackerone/">hackerone</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://thefawsec.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
